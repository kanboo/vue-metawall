var Z=Object.defineProperty,G=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var N=(c,t,n)=>t in c?Z(c,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):c[t]=n,y=(c,t)=>{for(var n in t||(t={}))K.call(t,n)&&N(c,n,t[n]);if(E)for(var n of E(t))Q.call(t,n)&&N(c,n,t[n]);return c},x=(c,t)=>G(c,J(t));import{r as j,o as d,c as u,a as s,t as p,e as M,d as D,U as $,v as ee,V,W as A,f as se,b as R,p as te,h as ae,X as oe,_ as le,S as re,Y as ne,u as ce,m as g,T as m,k as w,Z as ie,$ as de,D as ue,a0 as _e,q as B,s as k,a1 as O}from"./index.8544f707.js";const f=c=>(te("data-v-08c97d81"),c=c(),ae(),c),he={class:"personal bg_pattern"},fe={class:"container py-12 min-h-screen"},ve={class:"flex justify-between items-start gap-7"},pe={class:"flex-auto space-y-4"},ge={class:"relative p-10 z-[1]"},me={class:"absolute inset-0 after:inset-0 after:w-full after:h-full after:translate-x-[-7px] after:translate-y-[7px] after:content-[''] after:absolute after:bg-white after:border-2 after:border-black after:z-[-1] after:rounded-lg border-2 border-black rounded-lg bg-white flex justify-between items-center"},be={class:"border-r-2 border-black h-full flex-[0_0_auto] overflow-hidden"},ye=["src"],xe={class:"flex justify-between items-center w-full h-full p-4"},we={class:"font-bold"},ke={key:0},Se={key:1},Ce={class:"flex flex-col md:flex-row justify-between gap-2 md:gap-3"},Ie={class:"form-control"},Pe=f(()=>s("label",{for:"articleType"},null,-1)),De=["value"],Te=["value"],Fe={class:"input-group w-full"},Ue=f(()=>s("label",{for:"searchInput"},null,-1)),Le=f(()=>s("button",{type:"button",class:"bg-primary btn-square text-white border-2 border-l-0 border-black p-3"},[s("i",{class:"fa-solid fa-magnifying-glass text-xl"})],-1)),ze={key:1,class:"card-list relative space-y-4"},Ee=f(()=>s("span",null,"\u8F09\u5165\u6700\u65B0\u8CBC\u6587",-1)),Ne=[Ee],je={class:"card-body"},Me={class:"flex gap-4"},Ve=["src"],Ae={class:""},Re={class:"font-bold mb-1"},Be={class:"text-xs text-gray-base font-num"},Oe={class:"whitespace-pre-line"},Ye=["src"],qe={class:"flex items-center gap-2"},He=["onClick"],We=f(()=>s("i",{class:"fa-regular fa-thumbs-up text-primary mr-2"},null,-1)),Xe={class:"font-num text-xs"},Ze=["onClick"],Ge=f(()=>s("i",{class:"fa-regular fa-thumbs-up text-gray-base mr-2"},null,-1)),Je=f(()=>s("span",{class:"text-gray-base"},"\u6210\u70BA\u7B2C\u4E00\u500B\u6309\u8B9A\u7684\u670B\u53CB",-1)),Ke=[Ge,Je],Qe={key:2,class:"card"},$e=oe('<div class="card-header" data-v-08c97d81><div class="flex gap-[6px] p-4 border-b-2 border-black" data-v-08c97d81><div class="bg-danger-dark rounded-full h-2 w-2 border border-[#707070]" data-v-08c97d81></div><div class="bg-warning rounded-full h-2 w-2 border border-[#707070]" data-v-08c97d81></div><div class="bg-accent rounded-full h-2 w-2 border border-[#707070]" data-v-08c97d81></div></div></div><div class="card-bdoy p-8" data-v-08c97d81><p class="text-center text-gray-base" data-v-08c97d81>\u76EE\u524D\u5C1A\u7121\u52D5\u614B\uFF0C\u65B0\u589E\u4E00\u5247\u8CBC\u6587\u5427\uFF01</p></div>',2),es=[$e];function ss(c,t,n,l,T,S){const C=j("CardSkeleton"),b=j("SideMenu");return d(),u("div",he,[s("div",fe,[s("section",ve,[s("div",pe,[s("div",ge,[s("div",me,[s("div",be,[s("img",{src:l.normalizedUser.photoDisplay,class:"h-20 w-20 object-cover",alt:""},null,8,ye)]),s("div",xe,[s("div",null,[s("h1",we,p(l.normalizedUser.name),1),s("p",null,p(l.normalizedUser.followCount)+" \u4EBA\u8FFD\u8E64",1)]),l.isSelf?M("",!0):(d(),u("button",{key:0,type:"button",class:"btn bg-secondary group-focus:bg-gray shadow-bottom py-1 px-8 w-auto block group",onClick:t[0]||(t[0]=(...o)=>l.toggleFollow&&l.toggleFollow(...o))},[l.isFollowing?(d(),u("span",ke,"\u53D6\u6D88\u8FFD\u8E64")):(d(),u("span",Se,"\u8FFD\u8E64"))]))])])]),s("div",Ce,[s("div",Ie,[Pe,D(s("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>l.search.timeSort=o),name:"articleType",id:"articleType",class:"py-3 px-4 border-2 border-black h-full focus:outline-none"},[s("option",{value:l.SORT_TYPE.ASC},"\u6700\u820A\u8CBC\u6587",8,De),s("option",{value:l.SORT_TYPE.DESC},"\u6700\u65B0\u8CBC\u6587",8,Te)],512),[[$,l.search.timeSort]])]),s("div",Fe,[Ue,D(s("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>l.search.keyword=o),type:"text",id:"searchInput",name:"searchInput",placeholder:"\u641C\u5C0B\u8CBC\u6587",class:"w-full py-3 pl-4 border-2 border-black focus-visible:outline-none"},null,512),[[ee,l.search.keyword]]),Le])]),l.isFetchLoading?(d(),u(V,{key:0},A(2,o=>R(C)),64)):l.normalizedPosts.length?(d(),u("div",ze,[D(s("div",{class:"absolute -top-3 left-0 right-0 mx-auto flex justify-center items-center text-white text-center bg-primary opacity-95 w-32 py-2 rounded-full cursor-pointer",onClick:t[3]||(t[3]=(...o)=>l.getPosts&&l.getPosts(...o))},Ne,512),[[se,l.hasNewPosts]]),(d(!0),u(V,null,A(l.normalizedPosts,o=>(d(),u("div",{class:"card",key:o._id},[s("div",je,[s("div",Me,[s("img",{src:o.userPhoto,class:"w-full h-full max-h-[40px] max-w-[40px] rounded-full",alt:"avatarImage"},null,8,Ve),s("div",Ae,[s("p",Re,p(o.userName),1),s("p",Be,p(o.createdAtDisplay),1)])]),s("p",Oe,p(o.content),1),o.image?(d(),u("img",{key:0,src:o.image,class:"max-h-[157px] max-w-[485px] object-contain",alt:""},null,8,Ye)):M("",!0),s("div",qe,[o.likeCount?(d(),u("div",{key:0,class:"cursor-pointer",onClick:_=>l.toggleLike(o._id)},[We,s("span",Xe,p(o.likeCount),1)],8,He)):(d(),u("div",{key:1,class:"cursor-pointer",onClick:_=>l.toggleLike(o._id)},Ke,8,Ze))])])]))),128))])):(d(),u("div",Qe,es))]),R(b)])])])}const Y="https://api.iconify.design/ri:user-5-line.svg",q={ASC:"asc",DESC:"desc"},ts={name:"Personal",components:{SideMenu:re,CardSkeleton:ne},setup(){var z;const c=ce(),t=g(((z=c.params)==null?void 0:z.personalId)||m.value._id),n=g(null),l=w(()=>{var e;return m.value._id===((e=n.value)==null?void 0:e._id)}),T=w(()=>{var e,r,a,i;return x(y({},n.value),{photoDisplay:((e=n.value)==null?void 0:e.photo)||Y,followCount:(i=(a=(r=n.value)==null?void 0:r.followers)==null?void 0:a.length)!=null?i:0})}),S=w(()=>{var e,r;return(r=(e=n.value)==null?void 0:e.followers.some(a=>a.user._id===m.value._id))!=null?r:!1}),C=async()=>{try{B(!0),await k({method:S.value?"delete":"post",url:`/api/v1/user/${t.value}/follow`}),await b()}catch(e){console.error(e)}finally{B(!1)}},b=async()=>{var e,r;try{const a=await k.get(`/api/v1/user/profile/${t.value}`);n.value=(r=(e=a.data)==null?void 0:e.data)!=null?r:null}catch(a){console.error(a)}},o=g({timeSort:q.DESC,keyword:""}),_=g([]),F=g(!1),[H,I]=ie(!0),W=w(()=>_.value.map(e=>{var r,a,i,h,v;return x(y({},e),{userName:(a=(r=e==null?void 0:e.user)==null?void 0:r.name)!=null?a:"",userPhoto:((i=e==null?void 0:e.user)==null?void 0:i.photo)||Y,createdAtDisplay:de(new Date(e.createdAt),"yyyy-MM-dd HH:mm"),likeCount:(v=(h=e==null?void 0:e.likes)==null?void 0:h.length)!=null?v:0})})),P=O(async()=>{var e,r;try{I(!0);const a=x(y({},o.value),{user:t.value}),i=await k.get("/api/v1/posts",{params:a});_.value=(r=(e=i.data)==null?void 0:e.data)!=null?r:[],F.value=!1}catch(a){console.error(a)}finally{I(!1)}},500);ue(o.value,()=>P());const U=O(async(e,r)=>{try{const a=await k({method:e?"post":"delete",url:`/api/v1/post/${r}/like`}),i=_.value.findIndex(h=>h._id===a._id);i!==-1&&_.value.splice(i,1,a)}catch(a){console.error(a)}},1e3),X=e=>{const r=_.value.findIndex(v=>v._id===e);if(r===-1)return;const a=m.value._id,i=_.value[r],h=i.likes.findIndex(v=>v===a);h===-1?(i.likes.push(a),U(!0,e)):(i.likes.splice(h,1),U(!1,e))},L=async()=>{try{await b(),await P()}catch(e){console.error(e)}};return _e(async(e,r)=>{var a;e.params.personalId!==r.params.personalId&&(I(!0),t.value=((a=e.params)==null?void 0:a.personalId)||m.value._id,L())}),L(),{isSelf:l,normalizedUser:T,isFollowing:S,toggleFollow:C,SORT_TYPE:q,search:o,hasNewPosts:F,isFetchLoading:H,normalizedPosts:W,getPosts:P,toggleLike:X}}};var ls=le(ts,[["render",ss],["__scopeId","data-v-08c97d81"]]);export{ls as default};
