var C=Object.defineProperty;var _=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var b=(o,e,a)=>e in o?C(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a,g=(o,e)=>{for(var a in e||(e={}))k.call(e,a)&&b(o,a,e[a]);if(_)for(var a of _(e))S.call(e,a)&&b(o,a,e[a]);return o};import{r as F,o as c,c as p,a as t,d as U,v as I,U as M,e as V,b as B,p as D,g as N,_ as P,S as T,i as j,l as z,Y as q,q as h,m as x,a5 as E}from"./index.d589b3dc.js";const m=o=>(D("data-v-450707b3"),o=o(),N(),o),H={class:"post-create bg_pattern"},L={class:"container py-12 min-h-screen"},R={class:"flex justify-between items-start gap-7"},Y={class:"flex-auto space-y-4"},A=m(()=>t("div",{class:"relative p-8 z-[1]"},[t("h1",{class:"absolute inset-0 py-4 w-full border-2 border-black bg-white text-center text-xl font-bold after:inset-0 after:w-full after:h-full after:translate-x-[-7px] after:translate-y-[7px] after:content-[''] after:absolute after:bg-white after:border-2 after:border-black after:z-[-1]"}," \u5F35\u8CBC\u52D5\u614B ")],-1)),G={class:"card"},J={class:"card-body items-start p-8"},K={class:"form-control mx-auto space-y-1"},O=m(()=>t("label",{for:"postContent"},"\u8CBC\u6587\u5167\u5BB9",-1)),Q={for:"image-upload",class:"py-1 px-8 bg-black text-white rounded cursor-pointer w-auto"},W=m(()=>t("span",null,"\u4E0A\u50B3\u5716\u7247",-1)),X={key:0,style:{"border-top-color":"transparent"},class:"w-16 h-16 mx-auto border-4 border-blue-400 border-dotted rounded-full animate-spin"},Z=["src"],$={class:"w-4/6 mx-auto pt-4 group"},ee=["disabled"];function te(o,e,a,s,y,v){const r=F("SideMenu");return c(),p("div",H,[t("div",L,[t("section",R,[t("div",Y,[A,t("div",G,[t("div",J,[t("div",K,[O,U(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=n=>s.form.content=n),id:"postContent",type:"text",name:"postContent",rows:"6",cols:"45",class:"form-input py-3 px-6",placeholder:"\u8F38\u5165\u60A8\u7684\u8CBC\u6587\u5167\u5BB9"},null,512),[[I,s.form.content]])]),t("label",Q,[W,t("input",{id:"image-upload",type:"file",accept:"image/*",class:"hidden",onChange:e[1]||(e[1]=(...n)=>s.onFileChange&&s.onFileChange(...n))},null,32)]),s.isUploading?(c(),p("div",X)):(c(),p(M,{key:1},[s.form.image?(c(),p("img",{key:0,src:s.form.image,class:"mx-auto max-h-[157px] max-w-[485px] object-contain",alt:""},null,8,Z)):V("",!0)],64)),t("div",$,[t("button",{type:"button",class:"btn bg-info-dark hover:bg-secondary hover:shadow-side disabled:bg-gray-300 disabled:cursor-not-allowed disabled:shadow-none disabled:border-gray-400 disabled:text-gray-400",disabled:!s.form.content,onClick:e[2]||(e[2]=(...n)=>s.submit&&s.submit(...n))}," \u9001\u51FA\u8CBC\u6587 ",8,ee)])])])]),B(r)])])])}const oe={name:"PostCreate",components:{SideMenu:T},setup(){const o=j(),e=z({content:"",image:""}),[a,s]=q();return{form:e,isUploading:a,onFileChange:async r=>{var i,l,f;const n=r.target.files||r.dataTransfer.files;if(!!n.length)try{s(!0);const[d]=n,u=new FormData;u.append("image",d,d.name);const w=await h.post("/api/v1/image",u);e.value.image=(f=(l=(i=w.data)==null?void 0:i.data)==null?void 0:l.link)!=null?f:""}catch(d){console.error(d)}finally{s(!1)}},submit:async()=>{var r,n;try{if(!e.value.content)return;x(!0);const i=g({},e.value),l=await h.post("/api/v1/post",i);E.emit("post:create",{id:(n=(r=l.data)==null?void 0:r.data)==null?void 0:n.id}),o.push({name:"Home"})}catch(i){console.error(i)}finally{x(!1)}}}}};var ne=P(oe,[["render",te],["__scopeId","data-v-450707b3"]]);export{ne as default};
