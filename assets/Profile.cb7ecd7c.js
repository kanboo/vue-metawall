import{c as D,a as b,u as I,b as f,d as te}from"./object.f072a29b.js";import{r as ne,o as c,c as m,a as s,n as q,d as n,f as E,v as S,t as h,e as g,R as H,b as le,p as ie,h as de,_ as ce,S as me,m as j,T as P,q as v,s as F,x as ue}from"./index.8544f707.js";var _e="/assets/user_default.b2fc7dc2.png";const a=l=>(ie("data-v-7c7b1294"),l=l(),de(),l),fe={class:"profile bg_pattern"},pe={class:"container py-12 min-h-screen"},we={class:"flex justify-between items-start gap-7"},be={class:"flex-auto space-y-4"},he=a(()=>s("div",{class:"relative p-8 z-[1]"},[s("h1",{class:"absolute inset-0 py-4 w-full border-2 border-black bg-white text-center text-xl font-bold after:inset-0 after:w-full after:h-full after:translate-x-[-7px] after:translate-y-[7px] after:content-[''] after:absolute after:bg-white after:border-2 after:border-black after:z-[-1]"}," \u4FEE\u6539\u500B\u4EBA\u8CC7\u6599 ")],-1)),ge={class:"px-4 flex"},ve={id:"change",class:"card target:block"},xe={class:"flex flex-col space-y-4 p-8"},ye=["src"],Ee=["src"],Se={class:"text-danger text-center mb-4 list-decimal"},Pe=a(()=>s("li",null,"\u5716\u7247\u5BEC\u9AD8\u6BD4\u5FC5\u9700\u70BA 1:1\uFF0C\u8ACB\u91CD\u65B0\u8F38\u5165",-1)),Fe=a(()=>s("li",null,"\u89E3\u6790\u5EA6\u5BEC\u5EA6\u81F3\u5C11 300\u50CF\u7D20\u4EE5\u4E0A\uFF0C\u8ACB\u91CD\u65B0\u8F38\u5165",-1)),Te=[Pe,Fe],ke={for:"image-upload",class:"self-center py-1 px-6 bg-black text-white rounded cursor-pointer"},Ae=a(()=>s("span",null,"\u4E0A\u50B3\u5716\u7247",-1)),Me={class:"form-control mx-auto space-y-1 w-4/5"},Ce=a(()=>s("label",{for:"name"},"\u66B1\u7A31",-1)),Ge={key:0,class:"form-errorMsg register-style"},Ue={class:"form-control mx-auto space-y-1 w-4/5"},Ve=a(()=>s("h3",null,"\u6027\u5225",-1)),Re={class:"flex gap-6"},Ne={class:"flex items-center gap-3"},Be=["value"],Le=a(()=>s("label",{for:"userGenderMale"},"\u7537\u6027",-1)),De={class:"flex items-center gap-3"},Ie=["value"],qe=a(()=>s("label",{for:"userGenderFemale"},"\u5973\u6027",-1)),He={key:0,class:"form-errorMsg register-style"},je={class:"w-4/5 mx-auto mt-8 group"},ze={id:"reset",class:"card target:block"},Ye={class:"flex flex-col space-y-4 p-8"},Oe={class:"form-control mx-auto space-y-1 w-4/5"},Je=a(()=>s("label",{for:"newPassword"},"\u8F38\u5165\u65B0\u5BC6\u78BC",-1)),Ke={key:0,class:"form-errorMsg register-style"},Qe={class:"form-control mx-auto space-y-1 w-4/5"},We=a(()=>s("label",{for:"confirmPassword"},"\u518D\u6B21\u8F38\u5165",-1)),Xe={key:0,class:"form-errorMsg register-style"},Ze={class:"w-4/5 mx-auto pt-4"};function $e(l,o,T,e,k,A){const x=ne("SideMenu");return c(),m("div",fe,[s("div",pe,[s("section",we,[s("div",be,[he,s("div",null,[s("nav",ge,[s("a",{class:q(["border-2 border-black border-b-0 rounded-t-lg bg-white py-2 px-6 cursor-pointer",{"bg-black text-white":e.activeTab===e.TABES.CHANGE}]),onClick:o[0]||(o[0]=r=>e.changeTab(e.TABES.CHANGE))},"\u66B1\u7A31\u4FEE\u6539",2),s("a",{class:q(["border-2 border-black border-b-0 rounded-t-lg bg-white py-2 px-6 cursor-pointer",{"bg-black text-white":e.activeTab===e.TABES.RESET}]),onClick:o[1]||(o[1]=r=>e.changeTab(e.TABES.RESET))},"\u91CD\u8A2D\u5BC6\u78BC",2)]),n(s("div",ve,[s("div",xe,[e.photo?(c(),m("img",{key:0,src:e.photo,class:"mx-auto max-h-[107px] max-w-[107px] object-contain border-2 border-black rounded-full",alt:"user-image"},null,8,ye)):(c(),m("img",{key:1,src:e.IMG_DEFAULT_USER,class:"mx-auto",alt:"user-image"},null,8,Ee)),n(s("ol",Se,Te,512),[[E,!e.imageValidated]]),s("label",ke,[Ae,s("input",{id:"image-upload",type:"file",accept:"image/*",class:"hidden",onChange:o[2]||(o[2]=(...r)=>e.onFileChange&&e.onFileChange(...r))},null,32)]),s("div",Me,[Ce,n(s("input",{"onUpdate:modelValue":o[3]||(o[3]=r=>e.name=r),type:"text",class:"form-input py-2 px-6"},null,512),[[S,e.name]]),e.userFormErrors.name?(c(),m("span",Ge,h(e.userFormErrors.name),1)):g("",!0)]),s("div",Ue,[Ve,s("div",Re,[s("div",Ne,[n(s("input",{"onUpdate:modelValue":o[4]||(o[4]=r=>e.gender=r),value:e.GENDER_TYPE.MALE,type:"radio",class:"h-5 w-5 accent-black",id:"userGenderMale",name:"userGender"},null,8,Be),[[H,e.gender]]),Le]),s("div",De,[n(s("input",{"onUpdate:modelValue":o[5]||(o[5]=r=>e.gender=r),value:e.GENDER_TYPE.FEMALE,type:"radio",class:"h-5 w-5 accent-black",id:"userGenderFemale",name:"userGender"},null,8,Ie),[[H,e.gender]]),qe])]),e.userFormErrors.gender?(c(),m("span",He,h(e.userFormErrors.gender),1)):g("",!0)]),s("div",je,[s("button",{type:"button",class:"btn bg-secondary hover:bg-primary hover:text-white shadow-side",onClick:o[6]||(o[6]=(...r)=>e.onSubmitUserForm&&e.onSubmitUserForm(...r))}," \u9001\u51FA\u66F4\u65B0 ")])])],512),[[E,e.activeTab===e.TABES.CHANGE]]),n(s("div",ze,[s("div",Ye,[s("div",Oe,[Je,n(s("input",{"onUpdate:modelValue":o[7]||(o[7]=r=>e.newPassword=r),id:"newPassword",name:"newPassword",type:"password",class:"form-input py-2 px-6",placeholder:"\u8ACB\u8F38\u5165\u65B0\u5BC6\u78BC"},null,512),[[S,e.newPassword]]),e.passwordFormErrors.newPassword?(c(),m("span",Ke,h(e.passwordFormErrors.newPassword),1)):g("",!0)]),s("div",Qe,[We,n(s("input",{"onUpdate:modelValue":o[8]||(o[8]=r=>e.confirmPassword=r),id:"confirmPassword",name:"confirmPassword",type:"password",class:"form-input py-2 px-6",placeholder:"\u518D\u6B21\u8F38\u5165\u65B0\u5BC6\u78BC"},null,512),[[S,e.confirmPassword]]),e.passwordFormErrors.confirmPassword?(c(),m("span",Xe,h(e.passwordFormErrors.confirmPassword),1)):g("",!0)]),s("div",Ze,[s("button",{type:"button",class:"btn bg-secondary hover:bg-primary hover:text-white shadow-side",onClick:o[9]||(o[9]=(...r)=>e.onSubmitPasswordForm&&e.onSubmitPasswordForm(...r))}," \u91CD\u8A2D\u5BC6\u78BC ")])])],512),[[E,e.activeTab===e.TABES.RESET]])])]),le(x)])])])}const es={name:"Profile",components:{SideMenu:me},setup(){var C,G,U,V,R,N;const l={CHANGE:"change",RESET:"reset"},o=j(l.CHANGE),T=t=>{o.value=t},e={MALE:"male",FEMALE:"female"},k={name:(G=(C=P.value)==null?void 0:C.name)!=null?G:"",photo:(V=(U=P.value)==null?void 0:U.photo)!=null?V:"",gender:(N=(R=P.value)==null?void 0:R.gender)!=null?N:""},A=D({name:b().required("\u8ACB\u586B\u5BEB \u540D\u7A31").min(2,"\u540D\u7A31\u6700\u5C11 2 \u500B\u5B57\u5143"),gender:b().required("\u8ACB\u9078\u64C7 \u6027\u5225")}),{errors:x,handleSubmit:r}=I({validationSchema:A,initialValues:k}),y=j(!0),{value:M}=f("photo"),{value:z}=f("name"),{value:Y}=f("gender"),O=async t=>{var d,u,p;const i=t.target.files||t.dataTransfer.files;if(!!i.length)try{const[_]=i,w=new Image;w.src=URL.createObjectURL(_),await new Promise((re,ae)=>{w.onerror=()=>ae(),w.onload=()=>re()});const{width:se,height:B}=w;if(!(se===B&&B>=300)){y.value=!1;return}const L=new FormData;L.append("image",_,_.name);const oe=await F.post("/api/v1/image",L);M.value=(p=(u=(d=oe.data)==null?void 0:d.data)==null?void 0:u.link)!=null?p:"",y.value=!0}catch(_){console.error(_)}},J=r(async t=>{var i,d;try{v(!0);const p=(d=(i=(await F.patch("/api/v1/user/profile",t)).data)==null?void 0:i.data)!=null?d:null;ue(p)}catch(u){console.error(u)}finally{v(!1)}}),K={newPassword:"",confirmPassword:""},Q=D({newPassword:b().required("\u8ACB\u586B\u5BEB \u5BC6\u78BC").min(4,"\u5BC6\u78BC\u6700\u5C11 4 \u500B\u5B57\u5143"),confirmPassword:b().required("\u8ACB\u586B\u5BEB \u78BA\u8A8D\u5BC6\u78BC").oneOf([te("newPassword"),null],"\u5BC6\u78BC\u8F38\u5165\u4E0D\u4E00\u81F4")}),{errors:W,handleSubmit:X}=I({validationSchema:Q,initialValues:K}),{value:Z}=f("newPassword"),{value:$}=f("confirmPassword"),ee=X(async(t,i)=>{try{v(!0),await F.post("/api/v1/user/update-password",t),i.resetForm()}catch(d){console.error(d)}finally{v(!1)}});return{TABES:l,activeTab:o,changeTab:T,IMG_DEFAULT_USER:_e,GENDER_TYPE:e,photo:M,name:z,gender:Y,imageValidated:y,userFormErrors:x,onFileChange:O,onSubmitUserForm:J,newPassword:Z,confirmPassword:$,passwordFormErrors:W,onSubmitPasswordForm:ee}}};var rs=ce(es,[["render",$e],["__scopeId","data-v-7c7b1294"]]);export{rs as default};
